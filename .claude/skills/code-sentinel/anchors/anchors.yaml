triton-forward-k3plus:
  KERNEL_ENTRY:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: def semi_crf_streaming_scan_kernel(
    expected_line: 84
    drift_tolerance: 20
  MAIN_LOOP_START:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: 'for t in tl.range(1, T + 1):'
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 206
    drift_tolerance: 30
  RING_BUFFER_READ:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: ring_k_idx = start_pos % K
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 220
    drift_tolerance: 20
  NEGINF_GUARD:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: is_all_neginf = max_scores < (NEG_INF + 1.0)
    expected_line: 306
    drift_tolerance: 15
  RING_BUFFER_WRITE:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: ring_t_idx = t % K
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 329
    drift_tolerance: 20
  CHECKPOINT_SAVE:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: should_checkpoint = (t % CHECKPOINT_INTERVAL) == 0
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 338
    drift_tolerance: 25
  KERNEL_LAUNCH:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: def launch_streaming_triton_kernel(
    expected_line: 889
    drift_tolerance: 50
dispatch-overview:
  CAN_USE_TRITON:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: can_use_triton = HAS_TRITON and use_triton
    expected_line: 658
    drift_tolerance: 30
  STREAMING_ENTRY:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: def semi_crf_streaming_forward(
    expected_line: 494
    drift_tolerance: 50
  K1_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return LinearCRFStreaming.apply(
    expected_line: 612
    drift_tolerance: 30
  K2_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return SemiCRFK2Streaming.apply(
    expected_line: 638
    drift_tolerance: 30
  TRITON_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return SemiCRFStreamingTriton.apply(
    expected_line: 664
    drift_tolerance: 30
autograd-kernel-interface:
  TRITON_FORWARD_CLASS:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: class SemiCRFStreamingTriton(
    expected_line: 162
    drift_tolerance: 40
  PARTITION_VALIDATION:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: 'if not torch.isfinite(partition).all():'
    after: class SemiCRFStreamingTriton(
    expected_line: 228
    drift_tolerance: 30
crf-heads:
  CLASS_DEFINITION:
    file: src/flash_semicrf/nn.py
    pattern: 'class SemiMarkovCRFHead(nn.Module):'
    expected_line: 39
    drift_tolerance: 20
  INIT_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def __init__(
    after: class SemiMarkovCRFHead
    expected_line: 121
    drift_tolerance: 30
  BUILD_EDGE_TENSOR:
    file: src/flash_semicrf/nn.py
    pattern: def _build_edge_tensor(
    after: class SemiMarkovCRFHead
    expected_line: 189
    drift_tolerance: 20
  BUILD_DIFFERENTIABLE_EDGE:
    file: src/flash_semicrf/nn.py
    pattern: def _build_differentiable_edge(
    after: class SemiMarkovCRFHead
    expected_line: 226
    drift_tolerance: 20
  NEGINF_SAFE_SENTINEL:
    file: src/flash_semicrf/nn.py
    pattern: _NEGINF_SAFE = -1e18
    after: def _build_differentiable_edge(
    expected_line: 259
    drift_tolerance: 15
  FORWARD_EXACT:
    file: src/flash_semicrf/nn.py
    pattern: def _forward_exact(
    after: class SemiMarkovCRFHead
    expected_line: 279
    drift_tolerance: 30
  FORWARD_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def forward(
    after: class SemiMarkovCRFHead
    expected_line: 336
    drift_tolerance: 30
  ZERO_CENTER:
    file: src/flash_semicrf/nn.py
    pattern: scores_float = scores_float - scores_float.mean(dim=1, keepdim=True)
    after: def forward(
    expected_line: 408
    drift_tolerance: 20
  FLOAT64_CONVERT:
    file: src/flash_semicrf/nn.py
    pattern: scores_float = scores.double()
    after: def forward(
    expected_line: 406
    drift_tolerance: 20
  NAN_CHECK_PROJECTION:
    file: src/flash_semicrf/nn.py
    pattern: 'if scores.requires_grad and torch.isnan(scores).any():'
    expected_line: 378
    drift_tolerance: 25
  NAN_CHECK_CUMSUM:
    file: src/flash_semicrf/nn.py
    pattern: 'if cum_scores.requires_grad and torch.isnan(cum_scores).any():'
    expected_line: 415
    drift_tolerance: 25
  BACKEND_SELECT:
    file: src/flash_semicrf/nn.py
    pattern: def _select_backend(
    expected_line: 170
    drift_tolerance: 30
  COMPUTE_LOSS:
    file: src/flash_semicrf/nn.py
    pattern: def compute_loss(
    after: class SemiMarkovCRFHead
    expected_line: 445
    drift_tolerance: 30
  DECODE_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def decode(
    after: class SemiMarkovCRFHead
    expected_line: 530
    drift_tolerance: 30
  DECODE_TRACEBACK:
    file: src/flash_semicrf/nn.py
    pattern: def decode_with_traceback(
    after: class SemiMarkovCRFHead
    expected_line: 608
    drift_tolerance: 30
  STREAMING_FORWARD_CALL:
    file: src/flash_semicrf/nn.py
    pattern: partition = semi_crf_streaming_forward(
    after: def forward(
    expected_line: 423
    drift_tolerance: 30
