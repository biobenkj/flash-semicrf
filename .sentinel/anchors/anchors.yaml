triton-forward-k3plus:
  KERNEL_ENTRY:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: def semi_crf_streaming_scan_kernel(
    expected_line: 84
    drift_tolerance: 20
  MAIN_LOOP_START:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: 'for t in tl.range(1, T + 1):'
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 220
    drift_tolerance: 30
  RING_BUFFER_READ:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: ring_k_idx = start_pos % K
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 235
    drift_tolerance: 20
  NEGINF_GUARD:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: is_all_neginf = max_scores < (NEG_INF + 1.0)
    expected_line: 321
    drift_tolerance: 15
  RING_BUFFER_WRITE:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: ring_t_idx = t % K
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 344
    drift_tolerance: 20
  CHECKPOINT_SAVE:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: should_checkpoint = (t % CHECKPOINT_INTERVAL) == 0
    after: def semi_crf_streaming_scan_kernel(
    expected_line: 353
    drift_tolerance: 25
  KERNEL_LAUNCH:
    file: src/flash_semicrf/streaming/triton_forward.py
    pattern: def launch_streaming_triton_kernel(
    expected_line: 931
    drift_tolerance: 50
dispatch-overview:
  CAN_USE_TRITON:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: can_use_triton = HAS_TRITON and use_triton
    expected_line: 673
    drift_tolerance: 30
  STREAMING_ENTRY:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: def semi_crf_streaming_forward(
    expected_line: 498
    drift_tolerance: 50
  K1_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return LinearCRFStreaming.apply(
    expected_line: 627
    drift_tolerance: 30
  K2_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return SemiCRFK2Streaming.apply(
    expected_line: 653
    drift_tolerance: 30
  TRITON_DISPATCH:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: return SemiCRFStreamingTriton.apply(
    expected_line: 679
    drift_tolerance: 30
autograd-kernel-interface:
  TRITON_FORWARD_CLASS:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: class SemiCRFStreamingTriton(
    expected_line: 176
    drift_tolerance: 40
  PARTITION_VALIDATION:
    file: src/flash_semicrf/streaming/autograd.py
    pattern: 'if not torch.isfinite(partition).all():'
    after: class SemiCRFStreamingTriton(
    expected_line: 234
    drift_tolerance: 30
triton-backward-k3plus:
  BACKWARD_KERNEL_ENTRY:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "def semi_crf_streaming_backward_kernel("
    expected_line: 62
    drift_tolerance: 20
  BACKWARD_LAUNCHER:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "def launch_streaming_triton_backward("
    expected_line: 1127
    drift_tolerance: 50
  MARGINALS_LAUNCHER:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "def launch_streaming_triton_marginals("
    expected_line: 1549
    drift_tolerance: 50
  BARRIER_CHECKPOINT_LOAD:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "tl.debug_barrier()"
    after: "def semi_crf_streaming_backward_kernel("
    expected_line: 372
    drift_tolerance: 30
  VALIDATE_SHAPES:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "validate_streaming_shapes("
    after: "def launch_streaming_triton_backward("
    expected_line: 1224
    drift_tolerance: 30
  GRAD_WORKSPACE_ALLOC:
    file: src/flash_semicrf/streaming/triton_backward.py
    pattern: "grad_tr_workspace = torch.zeros("
    after: "def launch_streaming_triton_backward("
    expected_line: 1355
    drift_tolerance: 30
pytorch-forward-k3plus:
  FORWARD_ENTRY:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_streaming_forward_pytorch("
    expected_line: 609
    drift_tolerance: 50
  EDGE_BLOCK_COMPUTE:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def compute_edge_block_streaming("
    expected_line: 570
    drift_tolerance: 30
  RING_CHECKPOINT_ALLOC:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "ring_checkpoints = torch.full("
    after: "def semi_crf_streaming_forward_pytorch("
    expected_line: 657
    drift_tolerance: 30
  FORWARD_LOGSUMEXP:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "scores_over_src = torch.logsumexp("
    after: "def semi_crf_streaming_forward_pytorch("
    expected_line: 708
    drift_tolerance: 30
pytorch-backward-k3plus:
  BACKWARD_ENTRY:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_streaming_backward_pytorch("
    expected_line: 917
    drift_tolerance: 50
  MARGINALS_ENTRY:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_streaming_marginals_pytorch("
    expected_line: 1192
    drift_tolerance: 50
  VITERBI_ENTRY:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_streaming_viterbi_with_backpointers("
    expected_line: 797
    drift_tolerance: 50
k1-linear-crf:
  K1_FORWARD:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def linear_crf_forward_pytorch("
    expected_line: 34
    drift_tolerance: 20
  K1_BACKWARD:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def linear_crf_backward_pytorch("
    expected_line: 94
    drift_tolerance: 30
  K1_VITERBI:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def linear_crf_viterbi_pytorch("
    expected_line: 203
    drift_tolerance: 30
k2-fast-path:
  K2_FORWARD:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_k2_forward_pytorch("
    expected_line: 283
    drift_tolerance: 30
  K2_BACKWARD:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_k2_backward_pytorch("
    expected_line: 346
    drift_tolerance: 30
  K2_VITERBI:
    file: src/flash_semicrf/streaming/pytorch_reference.py
    pattern: "def semi_crf_k2_viterbi_pytorch("
    expected_line: 476
    drift_tolerance: 30
non-streaming-backends:
  SEMIMARKOV_CLASS:
    file: src/flash_semicrf/semimarkov.py
    pattern: "class SemiMarkov("
    expected_line: 7
    drift_tolerance: 10
  LOGPARTITION_ENTRY:
    file: src/flash_semicrf/semimarkov.py
    pattern: "def logpartition("
    after: "class SemiMarkov("
    expected_line: 35
    drift_tolerance: 30
  DP_STANDARD:
    file: src/flash_semicrf/semimarkov.py
    pattern: "def _dp_standard("
    after: "class SemiMarkov("
    expected_line: 228
    drift_tolerance: 30
  DP_SCAN_STREAMING:
    file: src/flash_semicrf/semimarkov.py
    pattern: "def _dp_scan_streaming("
    after: "class SemiMarkov("
    expected_line: 148
    drift_tolerance: 30
  DP_BINARY_TREE:
    file: src/flash_semicrf/semimarkov.py
    pattern: "def _dp_binary_tree("
    after: "class SemiMarkov("
    expected_line: 85
    drift_tolerance: 30
crf-heads:
  CLASS_DEFINITION:
    file: src/flash_semicrf/nn.py
    pattern: 'class SemiMarkovCRFHead(nn.Module):'
    expected_line: 39
    drift_tolerance: 20
  INIT_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def __init__(
    after: class SemiMarkovCRFHead
    expected_line: 121
    drift_tolerance: 30
  BUILD_EDGE_TENSOR:
    file: src/flash_semicrf/nn.py
    pattern: def _build_edge_tensor(
    after: class SemiMarkovCRFHead
    expected_line: 189
    drift_tolerance: 20
  BUILD_DIFFERENTIABLE_EDGE:
    file: src/flash_semicrf/nn.py
    pattern: def _build_differentiable_edge(
    after: class SemiMarkovCRFHead
    expected_line: 226
    drift_tolerance: 20
  NEGINF_SAFE_SENTINEL:
    file: src/flash_semicrf/nn.py
    pattern: _NEGINF_SAFE = -1e18
    after: def _build_differentiable_edge(
    expected_line: 259
    drift_tolerance: 15
  FORWARD_EXACT:
    file: src/flash_semicrf/nn.py
    pattern: def _forward_exact(
    after: class SemiMarkovCRFHead
    expected_line: 277
    drift_tolerance: 30
  FORWARD_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def forward(
    after: class SemiMarkovCRFHead
    expected_line: 334
    drift_tolerance: 30
  ZERO_CENTER:
    file: src/flash_semicrf/nn.py
    pattern: scores_float = scores_float - scores_float.mean(dim=1, keepdim=True)
    after: def forward(
    expected_line: 406
    drift_tolerance: 20
  FLOAT64_CONVERT:
    file: src/flash_semicrf/nn.py
    pattern: scores_float = scores.double()
    after: def forward(
    expected_line: 404
    drift_tolerance: 20
  NAN_CHECK_PROJECTION:
    file: src/flash_semicrf/nn.py
    pattern: 'if scores.requires_grad and torch.isnan(scores).any():'
    expected_line: 376
    drift_tolerance: 25
  NAN_CHECK_CUMSUM:
    file: src/flash_semicrf/nn.py
    pattern: 'if cum_scores.requires_grad and torch.isnan(cum_scores).any():'
    expected_line: 413
    drift_tolerance: 25
  BACKEND_SELECT:
    file: src/flash_semicrf/nn.py
    pattern: def _select_backend(
    expected_line: 170
    drift_tolerance: 30
  COMPUTE_LOSS:
    file: src/flash_semicrf/nn.py
    pattern: def compute_loss(
    after: class SemiMarkovCRFHead
    expected_line: 443
    drift_tolerance: 30
  DECODE_METHOD:
    file: src/flash_semicrf/nn.py
    pattern: def decode(
    after: class SemiMarkovCRFHead
    expected_line: 529
    drift_tolerance: 30
  DECODE_TRACEBACK:
    file: src/flash_semicrf/nn.py
    pattern: def decode_with_traceback(
    after: class SemiMarkovCRFHead
    expected_line: 608
    drift_tolerance: 30
  STREAMING_FORWARD_CALL:
    file: src/flash_semicrf/nn.py
    pattern: partition = semi_crf_streaming_forward(
    after: def forward(
    expected_line: 421
    drift_tolerance: 30
